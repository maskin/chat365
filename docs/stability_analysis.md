# Webアプリ化における安定性とスリープ・シャットダウン対策

## 結論
**「サーバー（放送実行機）」と「クライアント（操作端末）」を分ける構成** にすることで、操作用のPCやタブレットがスリープ・シャットダウンしても、放送機能には全く影響を与えない安定したシステムが構築可能です。

## 1. 推奨されるシステム構成

### A. サーバー（放送実行機）
*   **役割**: スケジュール管理、音声生成、**音声出力（スピーカー接続）**
*   **機器**: デスクトップPC、Mac mini、Raspberry Pi など
*   **設置場所**: 放送室やサーバールーム（PAアンプの近く）
*   **電源**: **常時ON**（または放送時間帯のみ自動起動）
*   **スリープ設定**: **「スリープしない」設定が必須**

### B. クライアント（操作端末）
*   **役割**: スケジュールの登録・編集、緊急放送の指示
*   **機器**: 社内のPC、iPad、タブレット、スマホ
*   **電源/スリープ**: **自由**（使わない時はスリープ・シャットダウンしてOK）

---

## 2. よくある懸念と回答

### Q1. 操作用のタブレットがスリープしたら放送は止まりますか？
**A. 止まりません。**
放送を実行するのは「サーバー」です。操作用のタブレットは、サーバーに「明日の12時に放送して」と指示（データ登録）を送るだけのリモコンのような役割です。指示さえ送っておけば、タブレットの電源が切れていても、サーバーが時間通りに放送を行います。

### Q2. サーバー（放送実行機）のスリープ対策はどうすればいいですか？
**A. OSの設定で回避します。**
*   **Windows**: 「電源とスリープ」設定で「なし」に設定。
*   **macOS**: 「ディスプレイがオフのときに自動でスリープさせない」をON。
*   **停電対策**: UPS（無停電電源装置）を導入し、復電後に自動起動するBIOS設定を行うことで、さらに盤石になります。

### Q3. Webブラウザで「自動再生」がブロックされませんか？
**A. サーバー側で再生するため問題ありません。**
ブラウザの自動再生ポリシー（ユーザー操作なしで音を鳴らすのを防ぐ機能）は、ブラウザで表示しているページに適用されます。
本システムでは、音声再生はブラウザ（クライアント）ではなく、サーバー上の Python プログラム (`afplay` 等) が直接行うため、ブラウザの制限を受けません。

---

## 3. 注意点：タブレット自体を「放送機」にする場合
もし、「サーバーを用意せず、タブレットを放送室に置いて、そのタブレットから音を出したい」という構成（Webブラウザで音を出す構成）にする場合は、以下の課題が発生するため**推奨しません**。

1.  **スリープ問題**: タブレットがスリープするとブラウザも停止し、放送されません（「Guided Access」や「Kioskモード」での回避が必要）。
2.  **自動再生ブロック**: ブラウザのセキュリティ機能により、時間になっても音が鳴らないリスクが高いです。

## まとめ
現在の `pai` の設計（Pythonバックエンドがスケジュール管理と音声再生を担当）は、**「1. 推奨されるシステム構成」** に合致しています。
したがって、操作用のWebアプリ（PC/タブレット）の電源状態を気にすることなく、安定した運用が可能です。
